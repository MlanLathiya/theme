{% assign column_per_row = section.settings.column_per_row %}

<div class="banner banner-grid {{section.settings.col_spacing}} {{ section.settings.inner_spacing }} {{section.settings.style}}  {% if section.settings.video_link != blank or section.settings.video_src != blank %}banner-video{% endif %} {{ section.settings.custom_class }} {{ section.settings.add_padding_top }} {{ section.settings.add_padding_bottom }} {{ section.settings.add_margin_top }} {{ section.settings.add_margin_bottom }} {{ section.settings.add_border_top }} {{ section.settings.add_border_bottom }} {{ section.settings.border_width }}{% unless section.settings.link_1 != blank or section.settings.link_2 != blank %} no-button{% endunless %}" {% if section.settings.background_color != '' %}style="background-color: {{ section.settings.background_color }}"{% endif %}>
    <div class="wrapper {{ section.settings.max_width }}">
        <div class="flex-grid {% if column_per_row == blank %}flex-no-wrap{% endif %}">
            {% for block in section.blocks limit: section.blocks.size %}
            <div class="col-img  {% if block.settings.image_hover %}col-img--hover{% endif %} {{column_per_row}} {% if block.settings.video_link != blank or block.settings.video_src != blank %}video{% endif %} {{ block.settings.text_color | escape }}">
                <div class="inner">
                    <div class="image {{ block.settings.image_width }} {% if block.settings.image_width == "image-auto" %}center{% endif %}">
                        {% if block.settings.link != blank %}<a class="link" href="{{ block.settings.link }}">{% endif %}	
                            {% if block.settings.image %}
                                <picture class="feature">
                                    <source media="(min-width: 992px)" srcset="{{ block.settings.image | img_url: '1920x' }}">
                                    {% if block.settings.mobile_image != blank %}
                                        <source srcset="{{ block.settings.mobile_image | img_url: 'master' }}">
                                    {% else %}
                                        <source srcset="{{ block.settings.image | img_url: 'x680', crop: 'center' }}">
                                    {% endif %}
                                    <img src="{{ block.settings.image | img_url: '1920x' }}" alt="{% if block.settings.image_alt != blank %}{{ block.settings.image_alt }}{% else %}{% if block.settings.title != blank %}{{ block.settings.title }}{% endif %}{% endif %}" />
                                </picture>

                                {% if block.settings.image_hover %}
                                <picture class="second">
                                    <source media="(min-width: 1024px)" srcset="{{ block.settings.image_hover | img_url: '1920x' }}">
                                    <source media="(min-width: 768px)" srcset="{{ block.settings.image_hover | img_url: '650x950', crop: 'center' }}">
                                    <source srcset="{{ block.settings.image_hover | img_url: '650x950', crop: 'center' }}">
                                    <img src="{{ block.settings.image_hover | img_url: '1920x' }}" alt="" />
                                </picture>
                                {% endif %}
                            {% else %}
                                {% if block.settings.video_src == blank %}
                                    {% assign video_link = block.settings.video_link %}
                                    {% assign video_id = block.settings.video_link.id %}
                                    {% if video_id != blank %}
                                        {% assign thumbnail_url = 'http://img.youtube.com/vi/' | append: video_id | append: '/maxresdefault.jpg' %}
                                        <img src="{{thumbnail_url}}" alt="" />
                                    {% else %}
                                        <span class="placeholder-background">
                                            {% capture current %}{% cycle 1, 2 %}{% endcapture %}
                                            {{ 'lifestyle-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
                                        </span>
                                    {% endif %}
                                {% else %}
                                    <span class="placeholder-background">
                                        {% capture current %}{% cycle 1, 2 %}{% endcapture %}
                                        {{ 'lifestyle-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
                                    </span>
                                {% endif %}
                            {% endif %}
                        {% if block.settings.link != blank %}</a>{% endif %}
                        {% if block.settings.video_src == blank %}
                            {% if block.settings.video_link != blank %}
                                <iframe allow="autoplay" frameborder="0" allowfullscreen="" src="https://www.youtube.com/embed/{{ block.settings.video_link.id }}?autoplay=1&mute=1&loop=1&playlist={{ block.settings.video_link.id }}&origin={{ shop.secure_url }}"></iframe>
                            {% endif %}
                        {% else %}
                            <video preload="auto" autoplay="autoplay" muted="muted" {% if block.settings.video_controls %}controls="controls"{%endif%} {% if block.settings.video_loop %}loop="loop"{%endif%} {% if block.settings.image %}poster="{{ block.settings.image | img_url: '1920x' }}"{% endif %} playsinline>
                                <source src="{{ block.settings.video_src | append: '.mp4' | file_url  }}" type="video/mp4"></source>
                                <source src="{{ block.settings.video_src | append: '.webm' | file_url  }}" type="video/webm"></source>
                                <source src="{{ block.settings.video_src | append: '.ogv' | file_url  }}" type="video/ogg"></source>
                            </video>
                        {% endif %}
                    </div>

                    {% if block.settings.title != blank or block.settings.content != blank or block.settings.link_1 != blank or block.settings.link_2 != blank %}
                        <div class="caption {{ block.settings.content_position }} {{ block.settings.vertical_align }} {{ block.settings.horizontal_align }} {% if block.settings.invert_colour_on_hover %}invert-colour{% endif %}">	
                            <div class="wrapper">
                                <div class="content">
                                    {% if block.settings.title != blank %}
                                        <{{ block.settings.title_tag }} class="title">{{ block.settings.title }}</{{ block.settings.title_tag }}>
                                    {% endif %}
                                    {% if block.settings.content != blank %}
                                        <div class="text">{{ block.settings.content }}</div>
                                    {% endif %}
                                    {% if block.settings.link_1 != blank or block.settings.link_2 != blank %}
                                    <div class="buttons {{ block.settings.button_position }}">
                                        {% if block.settings.link_1 != blank %}
                                            <a class="button" href="{{ block.settings.link_1 }}">{{ block.settings.button_text_1 }}</a>
                                        {% endif %}	
                                        {% if block.settings.link_2 != blank %}
                                            <a class="button" href="{{ block.settings.link_2 }}">{{ block.settings.button_text_2 }}</a>
                                        {% endif %}	
                                    </div>
                                    {% endif %}

                                    {% comment %}for hover only{% endcomment %}
                                    {% if block.settings.image_hover %}
                                        {% if block.settings.logo or block.settings.logo_svg %}
                                            <div class="logo">
                                                {% if block.settings.logo %}
                                                <img class="logo-feature" src="{{ block.settings.logo | img_url: '240x' }}" alt="" />
                                                {% else %}
                                                {{block.settings.logo_svg}}
                                                {% endif %}
                                            </div>                                        
                                        {% endif %}
                                        
                                        {% if block.settings.content_hover %}
                                        <div class="content-hover">
                                            {{block.settings.content_hover}}
                                            
                                        </div>
                                        {% endif %}
                                        <a href="#" class="hover-toggle"><span></span></a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>


{% schema %}
{
    "name": "Banner",    
    "max_blocks": 12,
    "settings": [
        {
            "type": "select",
            "id": "max_width",
            "label": "Max width",
            "options": [
                { "value": "", "label": "Wide Width" },
                { "value": "full-width", "label": "Full Width" },
                { "value": "narrow-width", "label": "Narrow Width" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "column_per_row",
            "label": "Column per row",
            "options": [
                { "value": "", "label": "Fit all" },
                { "value": "col col-6", "label": "2" },
                { "value": "col col-4", "label": "3" },
                { "value": "col col-3", "label": "4" },
                { "value": "col col-2-custom", "label": "5" },
                { "value": "col col-2", "label": "6" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "style",
            "label": "Style",
            "options": [
                { "value": "", "label": "None" },
                { "value": "style-image-hover", "label": "image hover" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "col_spacing",
            "label": "Col Spacing",
            "options": [
                { "value": "", "label": "Yes" },
                { "value": "col-spacing-0", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "inner_spacing",
            "label": "Content Spacing",
            "options": [
                { "value": "", "label": "None" },
                { "value": "spacing", "label": "Spacing Only" },
                { "value": "border-spacing", "label": "Border & Spacing" }
            ],
            "default": ""
        },
        {
            "type": "color",
            "id": "background_color",
            "label": "Background Color"
        },
        {
            "type": "select",
            "id": "add_border_top",
            "label": "Add border top?",
            "options": [
                { "value": "border-top", "label": "Yes" },
                { "value": "", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "add_border_bottom",
            "label": "Add border bottom?",
            "options": [
                { "value": "border-bottom", "label": "Yes" },
                { "value": "", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "border_width",
            "label": "Border Width",
            "options": [
                { "value": "", "label": "Border Ful Width" },
                { "value": "border-content-center", "label": "Border Wide Width" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "add_padding_top",
            "label": "Add padding top?",
            "options": [
                { "value": "padding-top", "label": "Yes" },
                { "value": "", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "add_padding_bottom",
            "label": "Add padding bottom?",
            "options": [
                { "value": "padding-bottom", "label": "Yes" },
                { "value": "", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "add_margin_top",
            "label": "Add margin top?",
            "options": [
                { "value": "margin-top", "label": "Yes" },
                { "value": "", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "select",
            "id": "add_margin_bottom",
            "label": "Add margin bottom?",
            "options": [
                { "value": "margin-bottom", "label": "Yes" },
                { "value": "", "label": "No" }
            ],
            "default": ""
        },
        {
            "type": "text",
            "id": "custom_class",
            "label": "Custom class"
        }
    ],
    "blocks": [
        {
            "type": "banner",
            "name": "Banner",            
            "settings": [
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                },
                {
                    "type": "image_picker",
                    "id": "mobile_image",
                    "label": "Mobile Image"
                },
                {
                    "type": "select",
                    "id": "image_width",
                    "label": "Image Width",
                    "options": [
                        { "value": "image-auto", "label": "Image width auto" },
                        { "value": "", "label": "Image 100% width" }
                    ],
                    "default": ""
                },
                {
                    "type": "text",
                    "id": "video_src",
                    "label": "Video filename",
                    "info": "Upload a .mp4, .webm, .ogv into the Files folder (Settings > Files) all with this name. So if one of your assets is 'my-video.mp4', then just enter 'my-video' here."
                },
                {
                    "type": "checkbox",
                    "id": "video_loop",
                    "label": "Loop video?",
                    "info": "Use to video file",
                    "default": true
                },
                {
                    "type": "checkbox",
                    "id": "video_controls",
                    "label": "Controls video?",
                    "info": "Use to video file",
                    "default": false
                }, 
                {
                    "type": "video_url",
                    "id": "video_link",
                    "label": "Video Link",
                    "info": "Use a youtube video",
                    "accept": ["youtube"]
                },
                {
                    "type": "url",
                    "id": "link",
                    "label": "Image Link"
                },
                {
                    "type": "select",
                    "id": "content_position",
                    "label": "Content Position",
                    "options": [
                        { "value": "located-image", "label": "Located on the image" },
                        { "value": "below-image", "label": "Below the image" }
                    ],
                    "default": "located-image"
                },  
                {
                    "type": "select",
                    "id": "text_color",
                    "label": "Text color",
                    "options": [
                        { "value": "text-light", "label": "Light" },
                        { "value": "text-dark", "label": "Dark" }
                    ],
                    "default": "text-light"
                },
                {
                    "type": "select",
                    "id": "vertical_align",
                    "label": "Vertical align",
                    "options": [
                        { "value": "top", "label": "Top" },
                        { "value": "middle", "label": "Middle" },
                        { "value": "bottom", "label": "Bottom" }
                    ],
                    "default": "middle",
                    "info": "Use for Located on the image"
                },
                {
                    "type": "select",
                    "id": "horizontal_align",
                    "label": "Horizontal align",
                    "options": [
                        { "value": "left", "label": "Left" },
                        { "value": "center", "label": "Center" },
                        { "value": "right", "label": "Right" }
                    ],
                    "default": "center"
                },
                {
                    "type": "text",
                    "id": "title",
                    "label": "Title",
                    "default": "Banner"
                },
                {
                    "type": "select",
                    "id": "title_tag",
                    "label": "Title H Tag",
                    "options": [
                        { "value": "h1", "label": "H1" },
                        { "value": "h2", "label": "H2" },
                        { "value": "h3", "label": "H3" },
                        { "value": "h4", "label": "H4" },
                        { "value": "h5", "label": "H5" },
                        { "value": "h6", "label": "H6" }
                    ],
                    "default": "h2"
                },  
                {
                    "type": "richtext",
                    "id": "content",
                    "label": "Content",
                    "default": "<p>Lorem ipsum dolor sit amet</p>"
                },
                {
                    "type": "url",
                    "id": "link_1",
                    "label": "Button Link 1"
                },
                {
                    "type": "text",
                    "id": "button_text_1",
                    "label": "Button Text 1",
                    "default": "Shop Now"
                },
                {
                    "type": "url",
                    "id": "link_2",
                    "label": "Button Link 2"
                },
                {
                    "type": "text",
                    "id": "button_text_2",
                    "label": "Button Text 2",
                    "default": "Shop Now"
                },
                {
                    "type": "select",
                    "id": "button_position",
                    "label": "Button Position",
                    "options": [
                        { "value": "button-top", "label": "Top" },
                        { "value": "button-below-content", "label": "Below Content" },
                        { "value": "button-bottom", "label": "Bottom" }
                    ],
                    "default": "button-below-content",
                    "info": "Use for Located on the image"
                },
                {
                    "type": "image_picker",
                    "id": "image_hover",
                    "label": "Image hover",
                    "info": "active only with image hover"
                },
                {  
                    "type": "checkbox",						  
                    "id": "invert_colour_on_hover",						  
                    "label": "Invert colour on hover",						  
                    "default": true,
                    "info": "active only with image hover"
                },
                {
                    "type": "image_picker",
                    "id": "logo",
                    "label": "Logo",
                    "info": "active only with image hover"
                },
                {
                    "type": "textarea",
                    "id": "logo_svg",
                    "label": "Logo 1 SVG",
                    "info": "active only with image hover"
                },
                {
                    "type": "richtext",
                    "id": "content_hover",
                    "label": "Content Hover",
                    "default": "<p>Lorem ipsum dolor sit amet</p>",
                    "info": "active only with image hover"
                }
            ]
        }
    ],
    "presets": [{
        "name": "Juno Banner Grid Video or Image",
        "category": "Banner"
    }]
}
{% endschema %}